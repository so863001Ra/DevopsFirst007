this is the real code of merge
